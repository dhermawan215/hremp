var Index=function(){const csrf_token=$('meta[name="csrf-token"]').attr("content");var handleDataDepartemen=function(){$("#departemenBaru").select2({allowClear:!0,placeholder:"pilih item departemen",dataType:"json",ajax:{method:"POST",url:url+"app/ajax/data-departemen-dropdown.php",data:function(params){return{search:params.term,page:params.page||1}},processResults:function(data,params){return params.page=params.page||1,{results:data.items,pagination:{more:!1}}}},templateResult:format,templateSelection:formatSelection})},handleDataCompany=function(){$("#CompanyBaru").select2({allowClear:!0,placeholder:"pilih item company",dataType:"json",ajax:{method:"POST",url:url+"app/ajax/data-company-dropdown.php",data:function(params){return{search:params.term,page:params.page||1}},processResults:function(data,params){return params.page=params.page||1,{results:data.items,pagination:{more:!1}}}},templateResult:format,templateSelection:formatSelection})};function format(repo){if(repo.loading)return repo.text;var $container=$("<div class='select2-result-repository clearfix'><div class='select2-result-repository__title'></div></div>");return $container.find(".select2-result-repository__title").text(repo.text),$container}function formatSelection(repo){return repo.text}var handleFormSubmit=function(){$("#btnBack").click((function(e){e.preventDefault(),window.location.href=url+"view/pages/employee/index.php"})),$("#formEmployeeMutasi").submit((function(e){e.preventDefault();const form=$(this);let formData=new FormData(form[0]);confirm("Apakah Data Sudah Sesuai?!")&&$.ajax({type:"POST",url:url+"app/ajax/employee-mutasi.php",data:formData,processData:!1,contentType:!1,success:function(response){let obj;!0===response.success?(toastr.success("Data Saved!"),setTimeout(()=>{document.location.href=url+"view/pages/employee/view-employee-history.php?dataId="+response.data},4e3)):$.each(response.data,(function(key,value){toastr.error(value)}))}})}))},handleGetKaryawan=function(){const karyawan=$("#emp_id").val();$.ajax({type:"POST",url:url+"app/ajax/emp-employee-mutasi.php",async:!1,data:{karyawan:karyawan,_token:csrf_token},success:function(response){$("#karyawanName").html(response.nama),$("#periode_masuk").val(response.tgl_masuk),$("#jabatan").val(response.jabatan),$("#CompanyLama").append($("<option>",{value:response.company,text:response.company_name,attr:"selected"})),$("#departemenLama").append($("<option>",{value:response.dept,text:response.dept_name,attr:"selected"}))}})},handleCbxForm=function(){$("#mutasiCbx").on("click",(function(){if($("#mutasiCbx").is(":checked")){$("#perubahanStatus").val("MUTASI").change(),$("#rotasiCbx").attr("disabled","disabled"),$("#promosiCbx").attr("disabled","disabled"),$("#demosiCbx").attr("disabled","disabled");const valueCbx=$(this).val();$("#cbxVal").val(valueCbx)}else $("#perubahanStatus").prop("selected",!1).find("option:first").prop("selected",!0),$("#rotasiCbx").removeAttr("disabled"),$("#promosiCbx").removeAttr("disabled"),$("#demosiCbx").removeAttr("disabled"),$("#cbxVal").val(0)})),$("#rotasiCbx").on("click",(function(){if($("#rotasiCbx").is(":checked")){$("#perubahanStatus").val("ROTASI").change(),$("#CompanyBaru").attr("disabled","disabled"),$("#promosiCbx").attr("disabled","disabled"),$("#mutasiCbx").attr("disabled","disabled"),$("#demosiCbx").attr("disabled","disabled");const valueCbx=$(this).val();$("#cbxVal").val(valueCbx)}else $("#perubahanStatus").prop("selected",!1).find("option:first").prop("selected",!0),$("#CompanyBaru").removeAttr("disabled"),$("#mutasiCbx").removeAttr("disabled"),$("#promosiCbx").removeAttr("disabled"),$("#demosiCbx").removeAttr("disabled"),$("#cbxVal").val(0)})),$("#promosiCbx").on("click",(function(){if($("#promosiCbx").is(":checked")){$("#perubahanStatus").val("PROMOSI").change(),$("#CompanyBaru").attr("disabled","disabled"),$("#mutasiCbx").attr("disabled","disabled"),$("#rotasiCbx").attr("disabled","disabled"),$("#demosiCbx").attr("disabled","disabled"),$("#departemenLama").attr("disabled","disabled");const valueCbx=$(this).val();$("#cbxVal").val(valueCbx)}else $("#perubahanStatus").prop("selected",!1).find("option:first").prop("selected",!0),$("#CompanyBaru").removeAttr("disabled"),$("#mutasiCbx").removeAttr("disabled"),$("#rotasiCbx").removeAttr("disabled"),$("#demosiCbx").removeAttr("disabled"),$("#departemenLama").removeAttr("disabled"),$("#cbxVal").val(0)})),$("#demosiCbx").on("click",(function(){if($("#demosiCbx").is(":checked")){$("#perubahanStatus").val("DEMOSI").change(),$("#CompanyBaru").attr("disabled","disabled"),$("#mutasiCbx").attr("disabled","disabled"),$("#rotasiCbx").attr("disabled","disabled"),$("#promosiCbx").attr("disabled","disabled"),$("#departemenLama").attr("disabled","disabled");const valueCbx=$(this).val();$("#cbxVal").val(valueCbx)}else $("#perubahanStatus").prop("selected",!1).find("option:first").prop("selected",!0),$("#CompanyBaru").removeAttr("disabled"),$("#mutasiCbx").removeAttr("disabled"),$("#rotasiCbx").removeAttr("disabled"),$("#promosiCbx").removeAttr("disabled"),$("#departemenLama").removeAttr("disabled"),$("#cbxVal").val(0)}))};return{init:function(){handleDataCompany(),handleFormSubmit(),handleGetKaryawan(),handleDataDepartemen(),handleCbxForm()}}}();$(document).ready((function(){Index.init()}));