var Index=function(){const csrf_token=$('meta[name="csrf-token"]').attr("content");var table,isMobile=window.matchMedia("only screen and (max-width: 767px)").matches,handleDataCompany=function(){table=$("#tableDocs").DataTable({responsive:!0,autoWidth:!0,pageLength:10,searching:!0,paging:!0,lengthMenu:[[10,25,50],[10,25,50]],language:{info:"Menampilkan _START_ - _END_ dari _TOTAL_ data",infoEmpty:"Menampilkan 0 - 0 dari 0 data",infoFiltered:"",zeroRecords:"Data tidak di temukan",loadingRecords:"Loading...",processing:"Processing..."},columnsDefs:[{searchable:!1,target:[0,1]},{orderable:!1,target:0}],processing:!0,serverSide:!0,ajax:{url:url+"app/ajax/documents-data.php",type:"POST",data:{_token:csrf_token}},columns:[{data:"rnum",orderable:!1},{data:"name",orderable:!1},{data:"upload_time",orderable:!1},{data:"action",orderable:!1}]}),isMobile?$("#tableDocs tbody").on("click","tr",(function(){handleShowPdfinMobile(table.row(this).data())})):$("#tableDocs tbody").on("click","tr",(function(){handleShowPdfinDesktop(table.row(this).data())}))},handleShowPdfinMobile=function(param){const pathMobile=param.path,nameMobile=param.name,pathMobileDownload=param.path;$(document).on("click","#btnShowDocs",(function(){$("#docsName").html(nameMobile),$("#downloadDocs").attr("href",pathMobileDownload),pdfElement="<iframe src="+pathMobile+' type="application/pdf" width="100%" height="350px"></iframe>',$("#pdfContainer").html(pdfElement)}))},handleShowPdfinDesktop=function(param){$("#docsName").html(param.name),$("#downloadDocs").attr("href",param.path),pdfElement="<object data="+param.path+' type="application/pdf" width="100%" height="350px"></object>',$("#pdfContainer").html(pdfElement)},handleDelete=function(){$(document).on("click",".btndel",(function(){const id=$(this).data("id");Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(result=>{result.isConfirmed&&$.ajax({type:"POST",url:url+"/app/ajax/documents-delete.php",data:{_token:csrf_token,ids:id},success:function(response){!0===response.success?(Swal.fire("Deleted!","Your file has been deleted.","success"),table.ajax.reload()):Swal.fire({icon:"error",title:"Oops...",text:"Internal Server Error"})},error:function(response){}})})}))},handleSubmitForm=function(){$("#formUploadDoc").submit((function(e){e.preventDefault();const form=$(this);let formData=new FormData(form[0]);$.ajax({type:"POST",url:url+"app/ajax/documents-upload.php",data:formData,processData:!1,contentType:!1,Cache:!1,success:function(response){let obj;!0===response.success?($.each(response.data,(function(key,value){toastr.success(value)})),setTimeout(()=>{location.reload()},2e3)):$.each(response.data,(function(key,value){toastr.error(value)}))}})}))};return{init:function(){handleDataCompany(),handleDelete(),handleSubmitForm()}}}();$(document).ready((function(){Index.init()}));